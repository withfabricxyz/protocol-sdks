#!/bin/bash

CONTRACTS_DIR="../contracts"
STPV2_DIR="../stp-v2"

TARGET_FILE="src/bytecode.ts"

echo '// This file is auto-generated by scripts/import_bytecode.sh' > $TARGET_FILE

contracts="CrowdFinancingV1 CrowdFinancingV1Factory ERC20Token SubscriptionTokenV1 SubscriptionTokenV1Factory"
for contract in $contracts; do
  echo "Importing Bytecode for contract ${contract} -> ${TARGET_FILE}"
  bytecode=$(cat ${CONTRACTS_DIR}/out/${contract}.sol/${contract}.json | jq -rj .bytecode.object)

  echo "// Bytecode for ${contract}">> $TARGET_FILE
  echo "export const ${contract}Bytecode = '${bytecode}';" >> $TARGET_FILE
  echo >> $TARGET_FILE
done

contracts="STPV2 STPV2Factory"
for contract in $contracts; do
  echo "Importing Bytecode for contract ${contract} -> ${TARGET_FILE}"
  bytecode=$(cat ${STPV2_DIR}/out/${contract}.sol/${contract}.json | jq -rj .bytecode.object)

  echo "// Bytecode for ${contract}">> $TARGET_FILE
  echo "export const ${contract}Bytecode = '${bytecode}';" >> $TARGET_FILE
  echo >> $TARGET_FILE
done
